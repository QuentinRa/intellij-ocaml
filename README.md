# intellij-ocaml

[![Checks](https://badgen.net/github/checks/QuentinRa/intellij-ocaml/)](https://github.com/QuentinRa/intellij-ocaml/actions)
[![Version](https://img.shields.io/jetbrains/plugin/v/18531-ocaml.svg)](https://plugins.jetbrains.com/plugin/18531-ocaml)
[![Downloads](https://img.shields.io/jetbrains/plugin/d/18531-ocaml.svg)](https://plugins.jetbrains.com/plugin/18531-ocaml)
[![License: MIT](https://badgen.net/github/license/quentinRa/intellij-ocaml?color=yellow)](LICENSE)
![Dependabot: Active](https://badgen.net/github/dependabot/QuentinRa/intellij-ocaml/)
[![0.2.0](https://badgen.net/github/milestones/quentinra/intellij-ocaml/1)](https://github.com/QuentinRa/intellij-ocaml/milestone/1)
[![0.3.0](https://badgen.net/github/milestones/quentinra/intellij-ocaml/2)](https://github.com/QuentinRa/intellij-ocaml/milestone/2)
[![0.4.0](https://badgen.net/github/milestones/quentinra/intellij-ocaml/3)](https://github.com/QuentinRa/intellij-ocaml/milestone/3)

<!--
At least for now, the repository is maintained.
[![No Maintenance Intended](http://unmaintained.tech/badge.svg)](http://unmaintained.tech/)
-->

This plugin is providing support for OCaml for JetBrains IDEs. It's based on both ReasonML and intellij-rust. If you are looking for a complete and maintained solution, please check out the [ReasonML](https://github.com/giraud/reasonml-idea-plugin) plugin. I'm a student, and I'm lacking the knowledge to do something great.

## üéØ What's my goal?

* [ ] Can run/compile ocaml files (without having to install some external build system)
* [ ] Support for opam (can install / update packages, ...)
* [ ] Support for Makefile
* [ ] Support for Dune (already supported in ReasonML)
* [x] Any installation must be simple, and effortless
* [ ] **Real-time checks for errors/warnings**, including quick fixes
* [x] **Real-time type inference**
* [ ] **Smart auto-completion**
* [x] **REPL support**: we must be able to send commands from our file, to a REPL console
* [x] **Using a bundle** (possible support for Localization later)
* [x] Working in minor IDEs (CLion, PHPStorm, etc.)

> Please note that some features are already available in ReasonML (ex: odoc support, dune support, etc.), and I will reuse (and hopefully improve) them. [List of features from the ReasonML plugin ü§©Ô∏è](ReasonML.md)

## ‚ú® Providers for OCaml

On Windows, I will support the use of Cygwin, OCaml64, or a WSL. Both ocaml installed with, or without opam should work. For the latter, some features won't be available, as some files will be missing.

On Linux, you can also use ocaml installed with, or without opam.

Finally, I'm planning to allow someone to compile on a remote host. This is an experimental feature (from the classes I inspected), so I'm not sure how it will go, but I will give it a try.

## üöÄ Features

| Setup                                                      |
|------------------------------------------------------------|
| ‚úÖ You got some instructions to install what you need       |
| ‚úÖ You can create a non-opam SDK                            |
| ‚úÖ You can create/add/use an opam SDK                       |
| ‚úÖ Set/Update the project SDK, you can use it in a module   |
| ‚úÖ Set/Update the SDK for a module                          |
| ‚úÖ Edit modules' properties (ex: output folder, src folder) |
| ‚úÖ You can use a template (‚úÖ Makefile, ‚úÖ Dune)              |
| ‚úÖ Can create a file (.ml, .mli, .ml+.mli)                  |
| ‚ùå The project is created with a default runConfiguration   |

You are now able to create a project using an opam SDK, or create an opam-like SDK. Opam like SDKs should be used if you are not using opam (ex: you only have /bin/ocaml, etc.). Two templates are available, one using a <b>Makefile</b>, and another using <b>Dune</b>.

| SDK                                                     |
|---------------------------------------------------------|
| ‚úÖ We are suggesting SDKs                                |
| ‚úÖ We are suggesting a location for non-opam SDKs        |
| ‚úÖ The SDK is verified                                   |
| ‚úÖ The user can add/remove sources                       |
| ‚úÖ The user see sources, only .ml/.mli files are shown   |
| ‚úÖ Suggest SDK if opening a file in a module without SDK |
| ‚ùå The user can download OCaml                           |
| ‚ùå The user can download sources                         |

An SDK is a folder (**named after its ocaml version** such as 4.05.0) in which you got a folder `bin` with `ocaml`, ... and a folder `lib` with the sources. The sources (from the GitHub repository), are stored in `.opam-switch/sources/` (optional).

| REPL Console                                          |
|-------------------------------------------------------|
| ‚úÖ Can execute commands                                |
| ‚úÖ Browse history, use arrow up/down                   |
| ‚úÖ See the values of the variables                     |
| ‚úÖ Send a file to the console                          |
| ‚úÖ Send the selection to the console                   |
| ‚úÖ Send a statement to the console                     |
| ‚úÖ Preview the auto-selected statement, can be changed |
| ‚ùå Multiples consoles                                  |
| ‚ùå Select the SDK used in a console                    |
| ‚ùå Use `utop`                                          |

This is a console allowing the use of the ocaml interpreter more easily. For instance, arrows up/down are now properly handled. You also got a history of your commands.

| Code highlighting                                |
|--------------------------------------------------|
| ‚úÖ .ml / .mli are highlighted (based on ReasonML) |
| ‚úÖ we can see warnings in the file                |
| ‚úÖ we can see errors in the file                  |
| ‚úÖ we can see alerts in the file                  |
| ‚úÖ errors are shown project-wide                  |
| ‚úÖ mli is compiled is present, when in a .ml      |
| ‚ùå handle dune projects                           |
| ‚ùå handle Makefile projects                       |

We are compiling the file, and parsing the output, to provide hints in the editor.

| New File                                               |
|--------------------------------------------------------|
| ‚úÖ Can create .ml, .mli, or .ml and .mli                |
| ‚úÖ Editor > File and Code Templates for .ml and .mli    |
| ‚úÖ Buttons to browse the OCaml Manual/API in the editor |

| OCaml                            |
|----------------------------------|
| ‚ùå Show names before parameters   |
| ‚úÖ Show types with `CTRL+SHIFT+P` |

| Editor for .annot                             |
|-----------------------------------------------|
| ‚úÖ See the source next to the content          |
| ‚úÖ Can click in the editor ‚û°Ô∏è show in the tree |
| ‚úÖ Can click in the tree ‚û°Ô∏è show in the source |

| Dune                                              |
|---------------------------------------------------|
| ‚úÖ Import every feature in ReasonML                |
| ‚ùå Suggest installing dune                         |
| ‚ùå Show a message when updating files not targeted |
| ‚ùå Show an icon to "reload" dune                   |

| Minor IDEs                                    |
|-----------------------------------------------|
| ‚ùå Can create a project with an SDK (+check)   |
| ‚ùå Can create a project from a template        |
| ‚úÖ Can use the REPL                            |
| ‚úÖ Highlight, .... (basic features)            |
| ‚ùå Can change the SDK                          |
| ‚ùå Warnings/Errors/... shown without compiling |

## üìñ Install ocaml and opam

<details>
<summary>Windows (with WSL, >= 2020.3 only)</summary>

On Windows, you may use a WSL (ex: Windows Store > Debian), then follows the instruction for Linux users
</details>

## üìÑ License

This project is [MIT licensed](LICENSE).